# get_records_failed_ids test cases
- description: All rows valid, mask all False (no failures)
  inputs:
    df:
      a: [1, 2, 3]
    failed_mask: [False, False, False]
    max_samples: 10
  expected:
    records_failed_ids: []

- description: All rows invalid, mask all True (all fail)
  inputs:
    df:
      a: [1, 2, 3]
    failed_mask: [True, True, True]
    max_samples: 10
  expected:
    records_failed_ids: [0, 1, 2]

- description: Mixed valid and invalid rows
  inputs:
    df:
      a: [10, 20, 30, 40]
    failed_mask: [False, True, False, True]
    max_samples: 10
  expected:
    records_failed_ids: [1, 3]

- description: Only last row invalid
  inputs:
    df:
      b: [5, 6, 7]
    failed_mask: [False, False, True]
    max_samples: 10
  expected:
    records_failed_ids: [2]

- description: Limit output by max_samples, more invalid than max_samples
  inputs:
    df:
      a: [0, 1, 2, 3, 4, 5, 6, 7]
    failed_mask: [True, True, True, True, True, True, True, True]
    max_samples: 3
  expected:
    records_failed_ids: [0, 1, 2]

- description: No rows in DataFrame
  inputs:
    df:
      a: []
    failed_mask: []
    max_samples: 10
  expected:
    records_failed_ids: []